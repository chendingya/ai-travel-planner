# æŠ€æœ¯è§„èŒƒæ–‡æ¡£ï¼ˆTSDï¼‰

**é¡¹ç›®åç§°**ï¼šæ‹¾å…‰ç»˜æ—…  
**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**åˆ›å»ºæ—¥æœŸ**ï¼š2026-01-21  
**é¢å‘å›¢é˜Ÿ**ï¼šå¼€å‘å›¢é˜Ÿ  
**è¯¦ç»†ç¨‹åº¦**ï¼šæ ‡å‡†ç‰ˆ

---

## 1. ç³»ç»Ÿæ¶æ„

### 1.1 æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å‰ç«¯åº”ç”¨                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Vue 3 SPA  â”‚  â”‚  Supabase JS â”‚  â”‚  AMap JS SDK â”‚     â”‚
â”‚  â”‚   (Vite)     â”‚  â”‚     SDK      â”‚  â”‚              â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                 â”‚                 â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                 â”‚
          â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         åç«¯æœåŠ¡                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Node.js    â”‚  â”‚   Express    â”‚  â”‚   Supabase   â”‚     â”‚
â”‚  â”‚   Backend    â”‚  â”‚   Server     â”‚  â”‚    Client    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                 â”‚                 â”‚              â”‚
â”‚         â–¼                 â–¼                 â–¼              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  AI Services â”‚  â”‚   LangChain  â”‚  â”‚    MCP       â”‚     â”‚
â”‚  â”‚              â”‚  â”‚   Manager    â”‚  â”‚    Service   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                 â”‚
          â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å¤–éƒ¨æœåŠ¡ & å­˜å‚¨                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  DeepSeek AI â”‚  â”‚  é«˜å¾·åœ°å›¾ APIâ”‚  â”‚  Supabase DB â”‚     â”‚
â”‚  â”‚   (LLM)      â”‚  â”‚              â”‚  â”‚  PostgreSQL  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æŠ€æœ¯æ ˆ

#### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**ï¼šVue 3.5.13 (Composition API)
- **æ„å»ºå·¥å…·**ï¼šVite 6.1.0
- **è·¯ç”±**ï¼šVue Router 4.5.0
- **çŠ¶æ€ç®¡ç†**ï¼šPinia 3.0.1
- **UI ç»„ä»¶**ï¼šè‡ªå®šä¹‰ç»„ä»¶ + CSS Modules
- **HTTP å®¢æˆ·ç«¯**ï¼šAxios 1.8.2
- **åœ°å›¾æœåŠ¡**ï¼šé«˜å¾·åœ°å›¾ JS API
- **è®¤è¯æœåŠ¡**ï¼šSupabase JS Client 2.47.8
- **å…¶ä»–**ï¼švue-markdown-render 2.2.1, html2canvas 1.4.1

#### åç«¯æŠ€æœ¯æ ˆ
- **è¿è¡Œæ—¶**ï¼šNode.js 18+
- **æ¡†æ¶**ï¼šExpress 4.21.2
- **AI SDK**ï¼š@langchain/core 0.3.39, @langchain/community 0.3.34
- **æ•°æ®åº“å®¢æˆ·ç«¯**ï¼š@supabase/supabase-js 2.47.8
- **å…¶ä»–**ï¼šcors 2.8.5, dotenv 16.4.7, openai 4.82.0

#### åŸºç¡€è®¾æ–½
- **æ•°æ®åº“**ï¼šSupabase PostgreSQL
- **è®¤è¯**ï¼šSupabase Auth
- **éƒ¨ç½²**ï¼šDocker + Docker Compose
- **API ç½‘å…³**ï¼šNginxï¼ˆå¯é€‰ï¼‰

---

## 2. æ•°æ®åº“è®¾è®¡

### 2.1 æ•°æ®åº“æ¦‚è§ˆ

ä½¿ç”¨ Supabase PostgreSQL ä½œä¸ºä¸»æ•°æ®åº“ï¼Œé‡‡ç”¨å…³ç³»å‹æ•°æ®æ¨¡å‹ã€‚

### 2.2 è¡¨ç»“æ„è®¾è®¡

#### 2.2.1 ç”¨æˆ·è¡¨ï¼ˆusersï¼‰

```sql
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  email VARCHAR(255) UNIQUE NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- ç´¢å¼•
CREATE INDEX idx_users_email ON users(email);
```

**å­—æ®µè¯´æ˜**ï¼š
- `id`ï¼šç”¨æˆ·å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆUUIDï¼‰
- `email`ï¼šç”¨æˆ·é‚®ç®±ï¼Œç”¨äºç™»å½•
- `created_at`ï¼šåˆ›å»ºæ—¶é—´
- `updated_at`ï¼šæ›´æ–°æ—¶é—´

---

#### 2.2.2 æ—…è¡Œæ–¹æ¡ˆè¡¨ï¼ˆplansï¼‰

```sql
CREATE TABLE plans (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  destination VARCHAR(255) NOT NULL,
  days INTEGER NOT NULL,
  start_date DATE NOT NULL,
  budget DECIMAL(10, 2) NOT NULL,
  people_count INTEGER NOT NULL,
  preferences JSONB DEFAULT '[]'::jsonb,
  days_detail JSONB NOT NULL,
  budget_breakdown JSONB NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- ç´¢å¼•
CREATE INDEX idx_plans_user_id ON plans(user_id);
CREATE INDEX idx_plans_destination ON plans(destination);
CREATE INDEX idx_plans_created_at ON plans(created_at DESC);

-- è§¦å‘å™¨ï¼šè‡ªåŠ¨æ›´æ–° updated_at
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER update_plans_updated_at
    BEFORE UPDATE ON plans
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();
```

**å­—æ®µè¯´æ˜**ï¼š
- `id`ï¼šæ–¹æ¡ˆå”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆUUIDï¼‰
- `user_id`ï¼šå…³è”çš„ç”¨æˆ· ID
- `destination`ï¼šç›®çš„åœ°
- `days`ï¼šæ—…è¡Œå¤©æ•°
- `start_date`ï¼šå‡ºå‘æ—¥æœŸ
- `budget`ï¼šæ€»é¢„ç®—
- `people_count`ï¼šäººæ•°
- `preferences`ï¼šåå¥½æ ‡ç­¾æ•°ç»„ï¼ˆJSONBï¼‰
- `days_detail`ï¼šè¯¦ç»†è¡Œç¨‹æ•°æ®ï¼ˆJSONBï¼‰
- `budget_breakdown`ï¼šé¢„ç®—åˆ†è§£ï¼ˆJSONBï¼‰

**JSONB ç»“æ„ç¤ºä¾‹**ï¼š

```json
// preferences
["æ–‡åŒ–", "ç¾é£Ÿ", "è‡ªç„¶"]

// days_detail
{
  "days": [
    {
      "day": 1,
      "activities": [
        {
          "time": "ä¸Šåˆ",
          "activity": "æ¸¸è§ˆå²³éº“å±±",
          "description": "å²³éº“å±±æ˜¯é•¿æ²™çš„æ ‡å¿—æ€§æ™¯ç‚¹...",
          "cost": 0
        },
        {
          "time": "ä¸­åˆ",
          "activity": "å“å°é•¿æ²™ç‰¹è‰²ç¾é£Ÿ",
          "description": "æ¨èï¼šè‡­è±†è…ã€ç³–æ²¹ç²‘ç²‘...",
          "cost": 50
        }
      ]
    }
  ]
}

// budget_breakdown
{
  "ä½å®¿": 1200,
  "é¤é¥®": 1000,
  "äº¤é€š": 500,
  "é—¨ç¥¨": 300
}
```

---

### 2.3 æ•°æ®å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    users    â”‚ 1   N â”‚    plans    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”€â”€â”€â”€â”€â”€â”€â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)     â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚ id (PK)     â”‚
â”‚ email       â”‚       â”‚ user_id (FK)â”‚
â”‚ created_at  â”‚       â”‚ destination â”‚
â”‚ updated_at  â”‚       â”‚ days        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ start_date  â”‚
                      â”‚ budget      â”‚
                      â”‚ preferences â”‚
                      â”‚ days_detail â”‚
                      â”‚ budget_...  â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2.4 æ•°æ®è®¿é—®ç­–ç•¥

#### 2.4.1 RLSï¼ˆè¡Œçº§å®‰å…¨ï¼‰ç­–ç•¥

```sql
-- å¯ç”¨ RLS
ALTER TABLE plans ENABLE ROW LEVEL SECURITY;

-- ç­–ç•¥ 1ï¼šç”¨æˆ·åªèƒ½æŸ¥çœ‹è‡ªå·±çš„æ–¹æ¡ˆ
CREATE POLICY "Users can view own plans"
  ON plans FOR SELECT
  USING (auth.uid() = user_id);

-- ç­–ç•¥ 2ï¼šç”¨æˆ·åªèƒ½æ’å…¥è‡ªå·±çš„æ–¹æ¡ˆ
CREATE POLICY "Users can insert own plans"
  ON plans FOR INSERT
  WITH CHECK (auth.uid() = user_id);

-- ç­–ç•¥ 3ï¼šç”¨æˆ·åªèƒ½æ›´æ–°è‡ªå·±çš„æ–¹æ¡ˆ
CREATE POLICY "Users can update own plans"
  ON plans FOR UPDATE
  USING (auth.uid() = user_id);

-- ç­–ç•¥ 4ï¼šç”¨æˆ·åªèƒ½åˆ é™¤è‡ªå·±çš„æ–¹æ¡ˆ
CREATE POLICY "Users can delete own plans"
  ON plans FOR DELETE
  USING (auth.uid() = user_id);
```

#### 2.4.2 æ•°æ®åº“è¿æ¥

åç«¯ä½¿ç”¨ Supabase Client è¿æ¥æ•°æ®åº“ï¼š

```javascript
import { createClient } from '@supabase/supabase-js';

const supabase = createClient(
  process.env.SUPABASE_URL,
  process.env.SUPABASE_ANON_KEY
);
```

---

## 3. API æ¥å£è§„èŒƒ

### 3.1 API æ¦‚è§ˆ

| æ¨¡å— | æ–¹æ³• | è·¯å¾„ | æè¿° |
|-----|------|------|------|
| è¡Œç¨‹è§„åˆ’ | POST | /api/parse-travel-info | è§£ææ—…è¡Œä¿¡æ¯ |
| è¡Œç¨‹è§„åˆ’ | POST | /api/plan | ç”Ÿæˆæ—…è¡Œè®¡åˆ’ |
| è¡Œç¨‹è§„åˆ’ | POST | /api/complete-plan | ç”Ÿæˆå®Œæ•´æ—…è¡Œè®¡åˆ’ |
| AI å¯¹è¯ | POST | /api/ai-chat | AI å¯¹è¯ |
| AI å¯¹è¯ | POST | /api/ai-chat/sessions | åˆ›å»ºä¼šè¯ |
| AI å¯¹è¯ | GET | /api/ai-chat/sessions | è·å–ä¼šè¯åˆ—è¡¨ |
| AI å¯¹è¯ | GET | /api/ai-chat/history/:id | è·å–ä¼šè¯å†å² |
| AI å¯¹è¯ | DELETE | /api/ai-chat/history/:id | åˆ é™¤ä¼šè¯ |
| AI å¯¹è¯ | PATCH | /api/ai-chat/sessions/:id | æ›´æ–°ä¼šè¯æ ‡é¢˜ |
| AI å¯¹è¯ | POST | /api/tts | è¯­éŸ³åˆæˆä»»åŠ¡ |
| AI å¯¹è¯ | GET | /api/tts/audio/:task_id | æŸ¥è¯¢è¯­éŸ³ä»»åŠ¡ |
| MCP | GET | /api/mcp/status | è·å– MCP å·¥å…·çŠ¶æ€ |
| å›¾ç‰‡ç”Ÿæˆ | GET | /api/image-providers | è·å–å›¾ç‰‡æä¾›å•† |
| å›¾ç‰‡ç”Ÿæˆ | POST | /api/generate-image | ç”Ÿæˆå›¾ç‰‡ |
| å›¾ç‰‡ç”Ÿæˆ | GET | /api/image-history | è·å–å›¾ç‰‡ç”Ÿæˆå†å² |
| æ˜ä¿¡ç‰‡ | POST | /api/generate-postcard | ç”Ÿæˆæ˜ä¿¡ç‰‡ |
| BGM æ­Œå• | POST | /api/generate-playlist | ç”Ÿæˆæ­Œå• |
| BGM æ­Œå• | GET | /api/playlist-history | è·å–æ­Œå•ç”Ÿæˆå†å² |
| åˆ†äº«æ–‡æ¡ˆ | POST | /api/generate-share-content | ç”Ÿæˆåˆ†äº«æ–‡æ¡ˆ |
| æç¤ºè¯ | POST | /api/generate-prompt | ç”Ÿæˆé€Ÿè®°å¡ç‰‡æç¤ºè¯ |
| æç¤ºè¯ | POST | /api/generate-postcard-prompt | ç”Ÿæˆæ˜ä¿¡ç‰‡æç¤ºè¯ |

### 3.2 é€šç”¨è§„èŒƒ

#### 3.2.1 è¯·æ±‚è§„èŒƒ

- Content-Type: `application/json`
- è®¤è¯æ–¹å¼ï¼šBearer Tokenï¼ˆSupabase JWTï¼‰
- åŸºç¡€è·¯å¾„ï¼š`http://localhost:3002/api`
- OpenAPI æ–‡æ¡£ï¼š`http://localhost:3002/api/docs`
- OpenAPI JSONï¼š`http://localhost:3002/api/openapi.json`

#### 3.2.2 å“åº”è§„èŒƒ

æˆåŠŸå“åº”ï¼šæ ¹æ®æ¥å£ä¸åŒè¿”å›å¯¹åº” JSONã€‚

é”™è¯¯å“åº”ï¼ˆç»Ÿä¸€æ ¼å¼ï¼‰ï¼š
```json
{
  "message": "é”™è¯¯ä¿¡æ¯",
  "error": "é”™è¯¯ä¿¡æ¯"
}
```

---

### 3.3 è¯¦ç»†æ¥å£æ–‡æ¡£

#### 3.3.1 è¡Œç¨‹è§„åˆ’æ¥å£

è®¤è¯ï¼šéœ€è¦

| æ–¹æ³• | è·¯å¾„ | è¯·æ±‚ä½“ |
|------|------|-------|
| POST | /api/parse-travel-info | `{ "quickInput"?: string, "text"?: string }` |
| POST | /api/plan | æ—…è¡Œè§„åˆ’è¡¨å• JSON |
| POST | /api/complete-plan | `{ "quickInput"?: string, "text"?: string }` |

è¿”å›ï¼šè§„åˆ’ç»“æœ JSONï¼ˆå­—æ®µéšè¾“å…¥ç•¥æœ‰å˜åŒ–ï¼‰ã€‚

---

#### 3.3.2 AI å¯¹è¯æ¥å£

è®¤è¯ï¼šéœ€è¦

| æ–¹æ³• | è·¯å¾„ | è¯·æ±‚ä½“/å‚æ•° |
|------|------|------------|
| POST | /api/ai-chat | `{ "message": string, "sessionId"?: string, "enable_tools"?: boolean, "include_audio"?: boolean, "voice"?: string, "language_type"?: string }` |
| POST | /api/ai-chat/sessions | `{ "title"?: string }` |
| GET | /api/ai-chat/sessions | æ—  |
| GET | /api/ai-chat/history/:id | è·¯å¾„å‚æ•° `id` |
| DELETE | /api/ai-chat/history/:id | è·¯å¾„å‚æ•° `id` |
| PATCH | /api/ai-chat/sessions/:id | `{ "title": string }` |
| POST | /api/tts | `{ "text": string, "voice"?: string }` |
| GET | /api/tts/audio/:task_id | è·¯å¾„å‚æ•° `task_id` |

è¿”å›ï¼šèŠå¤©/ä¼šè¯æ•°æ®æˆ– `{ "success": true }`ï¼Œè¯­éŸ³æ¥å£è¿”å› `{ "taskId": string }` æˆ–ä»»åŠ¡çŠ¶æ€ã€‚

---

#### 3.3.3 å›¾ç‰‡ç”Ÿæˆæ¥å£

è®¤è¯ï¼š`/api/image-providers` ä¸éœ€è¦ï¼Œå…¶ä½™éœ€è¦

| æ–¹æ³• | è·¯å¾„ | è¯·æ±‚ä½“/å‚æ•° |
|------|------|------------|
| GET | /api/image-providers | æ—  |
| POST | /api/generate-image | `{ "prompt": string, "style"?: string, "size"?: string, "provider"?: string }` |
| GET | /api/image-history | å¯é€‰æŸ¥è¯¢å‚æ•° `limit` |

è¿”å›ï¼šå›¾ç‰‡ç”Ÿæˆç»“æœæˆ–å†å²åˆ—è¡¨ã€‚

---

#### 3.3.4 æ˜ä¿¡ç‰‡æ¥å£

è®¤è¯ï¼šéœ€è¦

| æ–¹æ³• | è·¯å¾„ | è¯·æ±‚ä½“ |
|------|------|-------|
| POST | /api/generate-postcard | æ˜ä¿¡ç‰‡ç”Ÿæˆå‚æ•° JSON |

è¿”å›ï¼šæ˜ä¿¡ç‰‡ç”Ÿæˆç»“æœã€‚

---

#### 3.3.5 BGM æ­Œå•æ¥å£

è®¤è¯ï¼šéœ€è¦

| æ–¹æ³• | è·¯å¾„ | è¯·æ±‚ä½“/å‚æ•° |
|------|------|------------|
| POST | /api/generate-playlist | `{ "destination"?: string, "theme"?: string }` |
| GET | /api/playlist-history | æ—  |

è¿”å›ï¼šæ­Œå•ç”Ÿæˆç»“æœæˆ–å†å²åˆ—è¡¨ã€‚

---

#### 3.3.6 åˆ†äº«æ–‡æ¡ˆæ¥å£

è®¤è¯ï¼šéœ€è¦

| æ–¹æ³• | è·¯å¾„ | è¯·æ±‚ä½“ |
|------|------|-------|
| POST | /api/generate-share-content | `{ "destination"?: string, "platform"?: string, "style"?: string }` |

è¿”å›ï¼šæ–‡æ¡ˆç”Ÿæˆç»“æœã€‚

---

#### 3.3.7 æç¤ºè¯æ¥å£

è®¤è¯ï¼šéœ€è¦

| æ–¹æ³• | è·¯å¾„ | è¯·æ±‚ä½“ |
|------|------|-------|
| POST | /api/generate-prompt | `{ "text"?: string, "scene"?: string }` |
| POST | /api/generate-postcard-prompt | `{ "text"?: string, "scene"?: string }` |

è¿”å›ï¼šæç¤ºè¯ç”Ÿæˆç»“æœã€‚

---

#### 3.3.8 MCP æ¥å£

è®¤è¯ï¼šä¸éœ€è¦

| æ–¹æ³• | è·¯å¾„ | è¯·æ±‚ä½“/å‚æ•° |
|------|------|------------|
| GET | /api/mcp/status | å¯é€‰æŸ¥è¯¢å‚æ•° `scope` |

è¿”å›ï¼šMCP å·¥å…·çŠ¶æ€ã€‚

---

### 3.4 é”™è¯¯ç å®šä¹‰

| é”™è¯¯ç  | æè¿° | HTTP çŠ¶æ€ç  |
|--------|------|------------|
| `UNAUTHORIZED` | æœªæˆæƒ | 401 |
| `FORBIDDEN` | æ— æƒé™ | 403 |
| `NOT_FOUND` | èµ„æºä¸å­˜åœ¨ | 404 |
| `INVALID_PARAMS` | å‚æ•°éªŒè¯å¤±è´¥ | 400 |
| `AI_GENERATION_ERROR` | AI ç”Ÿæˆå¤±è´¥ | 500 |
| `RATE_LIMIT_EXCEEDED` | è¯·æ±‚è¿‡äºé¢‘ç¹ | 429 |
| `DATABASE_ERROR` | æ•°æ®åº“é”™è¯¯ | 500 |
| `INTERNAL_ERROR` | å†…éƒ¨é”™è¯¯ | 500 |

---

## 4. è®¤è¯ä¸æˆæƒ

### 4.1 è®¤è¯æ–¹æ¡ˆ

ä½¿ç”¨ **Supabase Auth** è¿›è¡Œç”¨æˆ·è®¤è¯ï¼Œé‡‡ç”¨ **OTPï¼ˆä¸€æ¬¡æ€§å¯†ç ï¼‰** ç™»å½•æ–¹å¼ã€‚

### 4.2 è®¤è¯æµç¨‹

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant Frontend as å‰ç«¯åº”ç”¨
    participant SupabaseAuth as Supabase Auth
    participant Email as é‚®ç®±æœåŠ¡
    
    User->>Frontend: è¾“å…¥é‚®ç®±
    Frontend->>SupabaseAuth: signInWithOtp({ email })
    SupabaseAuth->>Email: å‘é€é­”æ³•é“¾æ¥é‚®ä»¶
    Email-->>User: æ”¶åˆ°ç™»å½•é‚®ä»¶
    User->>Frontend: ç‚¹å‡»é‚®ä»¶é“¾æ¥
    Frontend->>SupabaseAuth: éªŒè¯ token å¹¶å»ºç«‹ä¼šè¯
    SupabaseAuth-->>Frontend: è¿”å› JWT token
    Frontend->>User: ç™»å½•æˆåŠŸ
```

### 4.3 å‰ç«¯è®¤è¯å®ç°

```javascript
import { createClient } from '@supabase/supabase-js';

const supabase = createClient(
  import.meta.env.VITE_SUPABASE_URL,
  import.meta.env.VITE_SUPABASE_ANON_KEY
);

// å‘é€ç™»å½•é“¾æ¥
async function sendLoginLink(email) {
  const { data, error } = await supabase.auth.signInWithOtp({
    email: email
  });
  
  if (error) throw error;
  return data;
}

// ç›‘å¬è®¤è¯çŠ¶æ€
supabase.auth.onAuthStateChange((event, session) => {
  if (session) {
    // ç”¨æˆ·å·²ç™»å½•
    localStorage.setItem('access_token', session.access_token);
  } else {
    // ç”¨æˆ·å·²ç™»å‡º
    localStorage.removeItem('access_token');
  }
});

// ç™»å‡º
async function logout() {
  const { error } = await supabase.auth.signOut();
  if (error) throw error;
}
```

### 4.4 åç«¯è®¤è¯éªŒè¯

```javascript
import { createClient } from '@supabase/supabase-js';

const supabase = createClient(
  process.env.SUPABASE_URL,
  process.env.SUPABASE_ANON_KEY
);

// éªŒè¯ JWT token
async function verifyToken(req, res, next) {
  const authHeader = req.headers.authorization;
  
  if (!authHeader || !authHeader.startsWith('Bearer ')) {
    return res.status(401).json({ 
      success: false, 
      error: 'æœªæä¾›è®¤è¯ä»¤ç‰Œ' 
    });
  }
  
  const token = authHeader.split(' ')[1];
  
  try {
    const { data: { user }, error } = await supabase.auth.getUser(token);
    
    if (error || !user) {
      return res.status(401).json({ 
        success: false, 
        error: 'æ— æ•ˆçš„è®¤è¯ä»¤ç‰Œ' 
      });
    }
    
    req.user = user;
    next();
  } catch (error) {
    return res.status(500).json({ 
      success: false, 
      error: 'è®¤è¯éªŒè¯å¤±è´¥' 
    });
  }
}

// ä½¿ç”¨ä¸­é—´ä»¶
app.post('/api/plan/save', verifyToken, async (req, res) => {
  // ç”¨æˆ·å·²è®¤è¯ï¼Œç»§ç»­å¤„ç†
  const userId = req.user.id;
  // ...
});
```

### 4.5 å®‰å…¨ç­–ç•¥

- **Token æœ‰æ•ˆæœŸ**ï¼šè®¿é—®ä»¤ç‰Œ 1 å°æ—¶ï¼Œåˆ·æ–°ä»¤ç‰Œ 30 å¤©
- **è‡ªåŠ¨åˆ·æ–°**ï¼šSupabase SDK è‡ªåŠ¨å¤„ç†ä»¤ç‰Œåˆ·æ–°
- **HTTPS**ï¼šç”Ÿäº§ç¯å¢ƒå¼ºåˆ¶ä½¿ç”¨ HTTPS
- **æ•æ„Ÿæ•°æ®**ï¼šä¸åœ¨å‰ç«¯æš´éœ²æœåŠ¡ç«¯å¯†é’¥

---

## 5. AI æœåŠ¡é›†æˆ

### 5.1 AI æœåŠ¡æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           åç«¯ AI æœåŠ¡å±‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ LangChain    â”‚  â”‚  MCP Service â”‚   â”‚
â”‚  â”‚  Manager     â”‚  â”‚              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚
          â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å¤–éƒ¨ AI æœåŠ¡                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  DeepSeek    â”‚  â”‚  OpenAI      â”‚   â”‚
â”‚  â”‚  API         â”‚  â”‚  API         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 DeepSeek API é›†æˆ

#### 5.2.1 é…ç½®

```javascript
// backend/src/config/index.js
module.exports = {
  deepseek: {
    apiKey: process.env.DEEPSEEK_API_KEY,
    baseURL: 'https://api.deepseek.com/v1',
    model: 'deepseek-chat',
    maxTokens: 2000,
    temperature: 0.7
  }
};
```

#### 5.2.2 è¡Œç¨‹è§„åˆ’ Prompt

```javascript
const generatePlanPrompt = (params) => {
  return `
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ—…è¡Œè§„åˆ’å¸ˆã€‚è¯·æ ¹æ®ä»¥ä¸‹ä¿¡æ¯ç”Ÿæˆè¯¦ç»†çš„æ—…è¡Œè®¡åˆ’ï¼š

ç›®çš„åœ°ï¼š${params.destination}
å¤©æ•°ï¼š${params.days}
å‡ºå‘æ—¥æœŸï¼š${params.startDate}
é¢„ç®—ï¼š${params.budget}å…ƒ
äººæ•°ï¼š${params.peopleCount}
åå¥½ï¼š${params.preferences.join('ã€')}

è¯·æŒ‰ç…§ä»¥ä¸‹ JSON æ ¼å¼è¿”å›ï¼š
{
  "destination": "ç›®çš„åœ°",
  "days": å¤©æ•°,
  "days_detail": {
    "days": [
      {
        "day": 1,
        "activities": [
          {
            "time": "ä¸Šåˆ/ä¸­åˆ/ä¸‹åˆ/æ™šä¸Š",
            "activity": "æ´»åŠ¨åç§°",
            "description": "è¯¦ç»†æè¿°",
            "cost": è´¹ç”¨
          }
        ]
      }
    ]
  },
  "total_budget": æ€»é¢„ç®—,
  "budget_breakdown": {
    "ä½å®¿": é‡‘é¢,
    "é¤é¥®": é‡‘é¢,
    "äº¤é€š": é‡‘é¢,
    "é—¨ç¥¨": é‡‘é¢
  }
}

è¦æ±‚ï¼š
1. æ¯å¤©å®‰æ’ 3-4 ä¸ªæ´»åŠ¨
2. æ€»é¢„ç®—æ§åˆ¶åœ¨ç”¨æˆ·é¢„ç®—èŒƒå›´å†…
3. æ´»åŠ¨è¦ç¬¦åˆç”¨æˆ·åå¥½
4. æ™¯ç‚¹è¦çœŸå®å­˜åœ¨
`;
};
```

#### 5.2.3 è°ƒç”¨å®ç°

```javascript
import OpenAI from 'openai';
import config from '../config/index.js';

const deepseekClient = new OpenAI({
  apiKey: config.deepseek.apiKey,
  baseURL: config.deepseek.baseURL
});

async function generateTravelPlan(params) {
  try {
    const response = await deepseekClient.chat.completions.create({
      model: config.deepseek.model,
      messages: [
        {
          role: 'system',
          content: 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ—…è¡Œè§„åˆ’å¸ˆã€‚'
        },
        {
          role: 'user',
          content: generatePlanPrompt(params)
        }
      ],
      temperature: config.deepseek.temperature,
      max_tokens: config.deepseek.maxTokens
    });

    const content = response.choices[0].message.content;
    const plan = JSON.parse(content);
    
    return { success: true, data: plan };
  } catch (error) {
    console.error('AI generation error:', error);
    return { 
      success: false, 
      error: 'AI ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•' 
    };
  }
}
```

---

### 5.3 LangChain é›†æˆ

#### 5.3.1 å·¥å…·å®šä¹‰

```javascript
// backend/src/services/langchain/tools/searchWeb.js
import { DynamicStructuredTool } from '@langchain/core/tools';
import { z } from 'zod';

export const searchWebTool = new DynamicStructuredTool({
  name: 'searchWeb',
  description: 'æœç´¢ç½‘ç»œä¿¡æ¯',
  schema: z.object({
    query: z.string().describe('æœç´¢æŸ¥è¯¢')
  }),
  func: async ({ query }) => {
    // å®ç°ç½‘ç»œæœç´¢é€»è¾‘
    return `æœç´¢ç»“æœï¼š${query}çš„ç›¸å…³ä¿¡æ¯...`;
  }
});

// backend/src/services/langchain/tools/searchTrainTickets.js
export const searchTrainTicketsTool = new DynamicStructuredTool({
  name: 'searchTrainTickets',
  description: 'æŸ¥è¯¢ç«è½¦ç¥¨ä¿¡æ¯',
  schema: z.object({
    from: z.string().describe('å‡ºå‘åœ°'),
    to: z.string().describe('ç›®çš„åœ°'),
    date: z.string().describe('å‡ºå‘æ—¥æœŸ')
  }),
  func: async ({ from, to, date }) => {
    // å®ç°ç«è½¦ç¥¨æŸ¥è¯¢é€»è¾‘
    return `ç«è½¦ç¥¨æŸ¥è¯¢ç»“æœï¼š${from} åˆ° ${to}ï¼Œ${date}`;
  }
});
```

#### 5.3.2 LangChain Manager

```javascript
// backend/src/services/langchain/LangChainManager.js
import { ChatOpenAI } from '@langchain/openai';
import { HumanMessage, SystemMessage } from '@langchain/core/messages';
import { searchWebTool, searchTrainTicketsTool } from './tools/index.js';

export class LangChainManager {
  constructor() {
    this.llm = new ChatOpenAI({
      modelName: 'deepseek-chat',
      openAIApiKey: process.env.DEEPSEEK_API_KEY,
      configuration: {
        baseURL: 'https://api.deepseek.com/v1'
      }
    });
    
    this.tools = {
      searchWeb: searchWebTool,
      searchTrainTickets: searchTrainTicketsTool
    };
  }

  async chat(messages, tools = []) {
    try {
      // æ„å»ºæ¶ˆæ¯
      const langchainMessages = messages.map(msg => {
        if (msg.role === 'system') {
          return new SystemMessage(msg.content);
        }
        return new HumanMessage(msg.content);
      });

      // è°ƒç”¨ LLM
      const response = await this.llm.invoke(langchainMessages);
      
      return {
        content: response.content,
        tool_calls: response.tool_calls || []
      };
    } catch (error) {
      console.error('LangChain error:', error);
      throw error;
    }
  }
}
```

---

### 5.4 MCP Service

```javascript
// backend/src/services/mcpService.js
export class MCPService {
  async handleToolCall(toolName, params) {
    switch (toolName) {
      case 'searchWeb':
        return await this.searchWeb(params.query);
      
      case 'searchTrainTickets':
        return await this.searchTrainTickets(params);
      
      default:
        throw new Error(`Unknown tool: ${toolName}`);
    }
  }

  async searchWeb(query) {
    // å®ç°ç½‘ç»œæœç´¢
    return {
      results: [
        {
          title: 'æœç´¢ç»“æœ 1',
          url: 'https://example.com',
          snippet: 'æ‘˜è¦...'
        }
      ]
    };
  }

  async searchTrainTickets(params) {
    // å®ç°ç«è½¦ç¥¨æŸ¥è¯¢
    return {
      from: params.from,
      to: params.to,
      date: params.date,
      tickets: [
        {
          trainNo: 'G123',
          departureTime: '09:00',
          arrivalTime: '12:00',
          price: 200
        }
      ]
    };
  }
}
```

---

## 6. å‰ç«¯å®ç°è§„èŒƒ

### 6.1 é¡¹ç›®ç»“æ„

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/          # ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ PlanForm.vue     # è¡Œç¨‹è¡¨å•
â”‚   â”‚   â”œâ”€â”€ PlanList.vue     # æ–¹æ¡ˆåˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ PlanDetail.vue   # æ–¹æ¡ˆè¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ MapView.vue      # åœ°å›¾è§†å›¾
â”‚   â”‚   â”œâ”€â”€ ChatBox.vue      # å¯¹è¯æ¡†
â”‚   â”‚   â”œâ”€â”€ AuthDialog.vue   # è®¤è¯å¯¹è¯æ¡†
â”‚   â”‚   â””â”€â”€ ...              # å…¶ä»–ç»„ä»¶
â”‚   â”œâ”€â”€ stores/              # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ planner.js       # è¡Œç¨‹è§„åˆ’çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ auth.js          # è®¤è¯çŠ¶æ€
â”‚   â”‚   â””â”€â”€ chat.js          # å¯¹è¯çŠ¶æ€
â”‚   â”œâ”€â”€ router/              # è·¯ç”±
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”œâ”€â”€ services/            # æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ api.js           # API å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ supabase.js      # Supabase å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ map.js           # åœ°å›¾æœåŠ¡
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ validators.js    # éªŒè¯å‡½æ•°
â”‚   â”‚   â””â”€â”€ formatters.js    # æ ¼å¼åŒ–å‡½æ•°
â”‚   â”œâ”€â”€ styles/              # æ ·å¼
â”‚   â”‚   â”œâ”€â”€ main.css
â”‚   â”‚   â””â”€â”€ variables.css
â”‚   â”œâ”€â”€ App.vue              # æ ¹ç»„ä»¶
â”‚   â””â”€â”€ main.js              # å…¥å£æ–‡ä»¶
â”œâ”€â”€ public/                  # é™æ€èµ„æº
â”œâ”€â”€ index.html
â”œâ”€â”€ vite.config.js
â””â”€â”€ package.json
```

---

### 6.2 çŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰

#### 6.2.1 è®¤è¯çŠ¶æ€

```javascript
// frontend/src/stores/auth.js
import { defineStore } from 'pinia';
import { supabase } from '../services/supabase';

export const useAuthStore = defineStore('auth', {
  state: () => ({
    user: null,
    session: null,
    loading: false,
    error: null
  }),

  getters: {
    isAuthenticated: (state) => !!state.user,
    userEmail: (state) => state.user?.email || ''
  },

  actions: {
    async initialize() {
      const { data: { session } } = await supabase.auth.getSession();
      this.session = session;
      this.user = session?.user || null;

      supabase.auth.onAuthStateChange((_event, session) => {
        this.session = session;
        this.user = session?.user || null;
      });
    },

    async sendLoginLink(email) {
      this.loading = true;
      this.error = null;

      try {
        const { error } = await supabase.auth.signInWithOtp({ email });
        if (error) throw error;
      } catch (error) {
        this.error = error.message;
        throw error;
      } finally {
        this.loading = false;
      }
    },

    async logout() {
      await supabase.auth.signOut();
      this.user = null;
      this.session = null;
    }
  }
});
```

#### 6.2.2 è¡Œç¨‹è§„åˆ’çŠ¶æ€

```javascript
// frontend/src/stores/planner.js
import { defineStore } from 'pinia';
import { api } from '../services/api';

export const usePlannerStore = defineStore('planner', {
  state: () => ({
    currentPlan: null,
    savedPlans: [],
    loading: false,
    error: null
  }),

  actions: {
    async generatePlan(params) {
      this.loading = true;
      this.error = null;

      try {
        const response = await api.post('/plan/generate', params);
        this.currentPlan = response.data;
        return response.data;
      } catch (error) {
        this.error = error.message;
        throw error;
      } finally {
        this.loading = false;
      }
    },

    async savePlan(plan) {
      try {
        const response = await api.post('/plan/save', plan);
        await this.fetchPlans();
        return response.data;
      } catch (error) {
        this.error = error.message;
        throw error;
      }
    },

    async fetchPlans() {
      try {
        const response = await api.get('/plan/list');
        this.savedPlans = response.data;
      } catch (error) {
        this.error = error.message;
        throw error;
      }
    },

    async deletePlan(planId) {
      try {
        await api.delete(`/plan/${planId}`);
        this.savedPlans = this.savedPlans.filter(
          plan => plan.id !== planId
        );
      } catch (error) {
        this.error = error.message;
        throw error;
      }
    }
  }
});
```

---

### 6.3 è·¯ç”±é…ç½®

```javascript
// frontend/src/router/index.js
import { createRouter, createWebHistory } from 'vue-router';
import { useAuthStore } from '../stores/auth';

const routes = [
  {
    path: '/',
    name: 'Home',
    component: () => import('../views/Home.vue')
  },
  {
    path: '/planner',
    name: 'Planner',
    component: () => import('../views/Planner.vue')
  },
  {
    path: '/plan/:id',
    name: 'PlanDetail',
    component: () => import('../views/PlanDetail.vue')
  },
  {
    path: '/chat',
    name: 'Chat',
    component: () => import('../views/Chat.vue')
  }
];

const router = createRouter({
  history: createWebHistory(),
  routes
});

// è·¯ç”±å®ˆå«
router.beforeEach((to, from, next) => {
  const authStore = useAuthStore();
  
  // éœ€è¦è®¤è¯çš„è·¯ç”±
  const requiresAuth = ['PlanDetail'].includes(to.name);
  
  if (requiresAuth && !authStore.isAuthenticated) {
    next({ name: 'Home', query: { redirect: to.fullPath } });
  } else {
    next();
  }
});

export default router;
```

---

### 6.4 API å®¢æˆ·ç«¯

```javascript
// frontend/src/services/api.js
import axios from 'axios';
import { supabase } from './supabase';

const api = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL || 'http://localhost:3000/api',
  timeout: 30000
});

// è¯·æ±‚æ‹¦æˆªå™¨
api.interceptors.request.use(
  async (config) => {
    // è‡ªåŠ¨æ·»åŠ è®¤è¯ token
    const { data: { session } } = await supabase.auth.getSession();
    if (session?.access_token) {
      config.headers.Authorization = `Bearer ${session.access_token}`;
    }
    return config;
  },
  (error) => {
    return Promise.reject(error);
  }
);

// å“åº”æ‹¦æˆªå™¨
api.interceptors.response.use(
  (response) => response.data,
  (error) => {
    if (error.response) {
      // å¤„ç†é”™è¯¯å“åº”
      const { data, status } = error.response;
      throw new Error(data.error || `è¯·æ±‚å¤±è´¥ (${status})`);
    }
    throw error;
  }
);

export default api;
```

---

### 6.5 åœ°å›¾é›†æˆï¼ˆé«˜å¾·åœ°å›¾ï¼‰

```javascript
// frontend/src/services/map.js
import AMapLoader from '@amap/amap-jsapi-loader';

export class MapService {
  constructor() {
    this.map = null;
    this.markers = [];
  }

  async initMap(containerId) {
    try {
      const AMap = await AMapLoader.load({
        key: import.meta.env.VITE_AMAP_KEY,
        version: '2.0',
        plugins: ['AMap.Scale', 'AMap.ToolBar', 'AMap.ControlBar']
      });

      this.map = new AMap.Map(containerId, {
        zoom: 11,
        center: [112.938814, 28.228209], // é•¿æ²™é»˜è®¤åæ ‡
        viewMode: '3D'
      });

      // æ·»åŠ æ§ä»¶
      this.map.addControl(new AMap.Scale());
      this.map.addControl(new AMap.ToolBar());
      this.map.addControl(new AMap.ControlBar());

      return this.map;
    } catch (error) {
      console.error('åœ°å›¾åˆå§‹åŒ–å¤±è´¥:', error);
      throw error;
    }
  }

  addMarkers(locations) {
    this.clearMarkers();

    locations.forEach(location => {
      const marker = new AMap.Marker({
        position: [location.longitude, location.latitude],
        title: location.name,
        icon: this.getMarkerIcon(location.type)
      });

      // æ·»åŠ ç‚¹å‡»äº‹ä»¶
      marker.on('click', () => {
        this.showInfoWindow(location);
      });

      this.markers.push(marker);
      this.map.add(marker);
    });

    // è‡ªåŠ¨è°ƒæ•´è§†é‡
    if (this.markers.length > 0) {
      this.map.setFitView(this.markers);
    }
  }

  clearMarkers() {
    this.markers.forEach(marker => {
      this.map.remove(marker);
    });
    this.markers = [];
  }

  showInfoWindow(location) {
    const infoWindow = new AMap.InfoWindow({
      content: `
        <div style="padding: 10px;">
          <h4>${location.name}</h4>
          <p>${location.description || ''}</p>
        </div>
      `
    });

    infoWindow.open(this.map, [location.longitude, location.latitude]);
  }

  getMarkerIcon(type) {
    // æ ¹æ®ç±»å‹è¿”å›ä¸åŒå›¾æ ‡
    const icons = {
      'æ™¯ç‚¹': 'ğŸ“',
      'ç¾é£Ÿ': 'ğŸ´',
      'é…’åº—': 'ğŸ¨',
      'è´­ç‰©': 'ğŸ›ï¸'
    };
    return icons[type] || 'ğŸ“';
  }
}

export const mapService = new MapService();
```

---

## 7. åç«¯å®ç°è§„èŒƒ

### 7.1 é¡¹ç›®ç»“æ„

```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config/              # é…ç½®
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”œâ”€â”€ controllers/         # æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ planController.js
â”‚   â”‚   â”œâ”€â”€ chatController.js
â”‚   â”‚   â””â”€â”€ imageController.js
â”‚   â”œâ”€â”€ routes/              # è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ index.js
â”‚   â”‚   â”œâ”€â”€ planRoutes.js
â”‚   â”‚   â”œâ”€â”€ chatRoutes.js
â”‚   â”‚   â””â”€â”€ imageRoutes.js
â”‚   â”œâ”€â”€ services/            # æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ planService.js
â”‚   â”‚   â”œâ”€â”€ aiChatService.js
â”‚   â”‚   â”œâ”€â”€ imageService.js
â”‚   â”‚   â”œâ”€â”€ langchain/
â”‚   â”‚   â”‚   â”œâ”€â”€ LangChainManager.js
â”‚   â”‚   â”‚   â””â”€â”€ tools/
â”‚   â”‚   â””â”€â”€ mcpService.js
â”‚   â”œâ”€â”€ middlewares/         # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ auth.js
â”‚   â”‚   â””â”€â”€ errorHandler.js
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ validators.js
â”‚   â”‚   â””â”€â”€ formatters.js
â”‚   â””â”€â”€ index.js             # å…¥å£æ–‡ä»¶
â”œâ”€â”€ uploads/                 # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”œâ”€â”€ .env.example
â”œâ”€â”€ Dockerfile
â””â”€â”€ package.json
```

---

### 7.2 ä¸­é—´ä»¶

#### 7.2.1 è®¤è¯ä¸­é—´ä»¶

```javascript
// backend/src/middlewares/auth.js
import { createClient } from '@supabase/supabase-js';

const supabase = createClient(
  process.env.SUPABASE_URL,
  process.env.SUPABASE_ANON_KEY
);

export async function verifyToken(req, res, next) {
  const authHeader = req.headers.authorization;
  
  if (!authHeader || !authHeader.startsWith('Bearer ')) {
    return res.status(401).json({ 
      success: false, 
      error: 'æœªæä¾›è®¤è¯ä»¤ç‰Œ' 
    });
  }
  
  const token = authHeader.split(' ')[1];
  
  try {
    const { data: { user }, error } = await supabase.auth.getUser(token);
    
    if (error || !user) {
      return res.status(401).json({ 
        success: false, 
        error: 'æ— æ•ˆçš„è®¤è¯ä»¤ç‰Œ' 
      });
    }
    
    req.user = user;
    next();
  } catch (error) {
    return res.status(500).json({ 
      success: false, 
      error: 'è®¤è¯éªŒè¯å¤±è´¥' 
    });
  }
}
```

#### 7.2.2 é”™è¯¯å¤„ç†ä¸­é—´ä»¶

```javascript
// backend/src/middlewares/errorHandler.js

export function errorHandler(err, req, res, next) {
  console.error('Error:', err);

  if (err.name === 'ValidationError') {
    return res.status(400).json({
      success: false,
      error: err.message,
      code: 'INVALID_PARAMS'
    });
  }

  if (err.name === 'UnauthorizedError') {
    return res.status(401).json({
      success: false,
      error: 'æœªæˆæƒ',
      code: 'UNAUTHORIZED'
    });
  }

  if (err.code === '23503') { // PostgreSQL å¤–é”®çº¦æŸé”™è¯¯
    return res.status(404).json({
      success: false,
      error: 'å…³è”èµ„æºä¸å­˜åœ¨',
      code: 'NOT_FOUND'
    });
  }

  // é»˜è®¤é”™è¯¯å“åº”
  res.status(500).json({
    success: false,
    error: 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯',
    code: 'INTERNAL_ERROR'
  });
}
```

---

### 7.3 æ§åˆ¶å™¨ç¤ºä¾‹

```javascript
// backend/src/controllers/planController.js
import { planService } from '../services/planService.js';

export const planController = {
  async generate(req, res, next) {
    try {
      const params = req.body;
      const result = await planService.generate(params);
      
      res.json({
        success: true,
        data: result,
        message: 'æ–¹æ¡ˆç”ŸæˆæˆåŠŸ'
      });
    } catch (error) {
      next(error);
    }
  },

  async save(req, res, next) {
    try {
      const userId = req.user.id;
      const planData = req.body;
      const result = await planService.save(userId, planData);
      
      res.json({
        success: true,
        data: result,
        message: 'ä¿å­˜æˆåŠŸ'
      });
    } catch (error) {
      next(error);
    }
  },

  async list(req, res, next) {
    try {
      const userId = req.user.id;
      const plans = await planService.list(userId);
      
      res.json({
        success: true,
        data: plans,
        message: 'æŸ¥è¯¢æˆåŠŸ'
      });
    } catch (error) {
      next(error);
    }
  },

  async delete(req, res, next) {
    try {
      const userId = req.user.id;
      const planId = req.params.id;
      await planService.delete(userId, planId);
      
      res.json({
        success: true,
        message: 'åˆ é™¤æˆåŠŸ'
      });
    } catch (error) {
      next(error);
    }
  },

  async getDetail(req, res, next) {
    try {
      const userId = req.user.id;
      const planId = req.params.id;
      const plan = await planService.getDetail(userId, planId);
      
      res.json({
        success: true,
        data: plan,
        message: 'æŸ¥è¯¢æˆåŠŸ'
      });
    } catch (error) {
      next(error);
    }
  }
};
```

---

### 7.4 æœåŠ¡å±‚ç¤ºä¾‹

```javascript
// backend/src/services/planService.js
import { createClient } from '@supabase/supabase-js';
import { aiChatService } from './aiChatService.js';

const supabase = createClient(
  process.env.SUPABASE_URL,
  process.env.SUPABASE_SERVICE_ROLE_KEY
);

export const planService = {
  async generate(params) {
    // è°ƒç”¨ AI æœåŠ¡ç”Ÿæˆæ–¹æ¡ˆ
    const result = await aiChatService.generatePlan(params);
    return result;
  },

  async save(userId, planData) {
    const { data, error } = await supabase
      .from('plans')
      .insert({
        user_id: userId,
        destination: planData.destination,
        days: planData.days,
        start_date: planData.startDate,
        budget: planData.budget,
        people_count: planData.peopleCount,
        preferences: planData.preferences,
        days_detail: planData.daysDetail,
        budget_breakdown: planData.budgetBreakdown
      })
      .select()
      .single();

    if (error) throw error;
    return data;
  },

  async list(userId) {
    const { data, error } = await supabase
      .from('plans')
      .select('id, destination, days, budget, created_at')
      .eq('user_id', userId)
      .order('created_at', { ascending: false });

    if (error) throw error;
    return data;
  },

  async delete(userId, planId) {
    const { error } = await supabase
      .from('plans')
      .delete()
      .eq('id', planId)
      .eq('user_id', userId); // ç¡®ä¿åªèƒ½åˆ é™¤è‡ªå·±çš„æ–¹æ¡ˆ

    if (error) throw error;
  },

  async getDetail(userId, planId) {
    const { data, error } = await supabase
      .from('plans')
      .select('*')
      .eq('id', planId)
      .eq('user_id', userId)
      .single();

    if (error) throw error;
    return data;
  }
};
```

---

## 8. éƒ¨ç½²è§„èŒƒ

### 8.1 Docker é…ç½®

#### 8.1.1 å‰ç«¯ Dockerfile

```dockerfile
# frontend/Dockerfile

# æ„å»ºé˜¶æ®µ
FROM node:18-alpine AS builder

WORKDIR /app

COPY package*.json ./
RUN npm install

COPY . .
RUN npm run build

# ç”Ÿäº§é˜¶æ®µ
FROM nginx:alpine

COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/nginx.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

#### 8.1.2 åç«¯ Dockerfile

```dockerfile
# backend/Dockerfile

FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm install --production

COPY . .

RUN npm run build

EXPOSE 3000

CMD ["node", "dist/index.js"]
```

---

### 8.2 Docker Compose é…ç½®

```yaml
version: '3.8'

services:
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "80:80"
    depends_on:
      - backend
    environment:
      - VITE_API_BASE_URL=http://localhost:3000/api
      - VITE_SUPABASE_URL=${SUPABASE_URL}
      - VITE_SUPABASE_ANON_KEY=${SUPABASE_ANON_KEY}
      - VITE_AMAP_KEY=${AMAP_KEY}

  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - SUPABASE_URL=${SUPABASE_URL}
      - SUPABASE_ANON_KEY=${SUPABASE_ANON_KEY}
      - SUPABASE_SERVICE_ROLE_KEY=${SUPABASE_SERVICE_ROLE_KEY}
      - DEEPSEEK_API_KEY=${DEEPSEEK_API_KEY}
      - AMAP_KEY=${AMAP_KEY}
    volumes:
      - ./backend/uploads:/app/uploads
    restart: unless-stopped
```

---

### 8.3 ç¯å¢ƒå˜é‡é…ç½®

#### åç«¯ .env æ–‡ä»¶

```env
# Supabase
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# DeepSeek AI
DEEPSEEK_API_KEY=your-deepseek-api-key

# é«˜å¾·åœ°å›¾
AMAP_KEY=your-amap-key

# æœåŠ¡é…ç½®
PORT=3000
NODE_ENV=production
```

#### å‰ç«¯ .env æ–‡ä»¶

```env
VITE_API_BASE_URL=http://localhost:3000/api
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key
VITE_AMAP_KEY=your-amap-key
```

---

### 8.4 éƒ¨ç½²æµç¨‹

#### 8.4.1 æœ¬åœ°å¼€å‘

```bash
# å¯åŠ¨å‰ç«¯
cd frontend
npm install
npm run dev

# å¯åŠ¨åç«¯
cd backend
npm install
npm run dev
```

#### 8.4.2 Docker éƒ¨ç½²

```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down
```

#### 8.4.3 ç”Ÿäº§éƒ¨ç½²

1. **å‡†å¤‡ç¯å¢ƒå˜é‡**
   ```bash
   cp .env.example .env
   # ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥çœŸå®çš„é…ç½®å€¼
   ```

2. **æ„å»ºé•œåƒ**
   ```bash
   docker-compose build
   ```

3. **å¯åŠ¨æœåŠ¡**
   ```bash
   docker-compose up -d
   ```

4. **éªŒè¯éƒ¨ç½²**
   ```bash
   # æ£€æŸ¥æœåŠ¡çŠ¶æ€
   docker-compose ps
   
   # æŸ¥çœ‹æ—¥å¿—
   docker-compose logs -f backend
   docker-compose logs -f frontend
   ```

---

## 9. æµ‹è¯•è§„èŒƒ

### 9.1 å•å…ƒæµ‹è¯•

```javascript
// backend/src/services/__tests__/planService.test.js
import { describe, it, expect, beforeEach, jest } from '@jest/globals';
import { planService } from '../planService';

describe('planService', () => {
  beforeEach(() => {
    // æ¸…ç†æµ‹è¯•æ•°æ®
  });

  describe('generate', () => {
    it('should generate a travel plan', async () => {
      const params = {
        destination: 'é•¿æ²™',
        days: 5,
        startDate: '2026-02-01',
        budget: 3000,
        peopleCount: 2,
        preferences: ['æ–‡åŒ–', 'ç¾é£Ÿ']
      };

      const result = await planService.generate(params);

      expect(result).toBeDefined();
      expect(result.destination).toBe('é•¿æ²™');
      expect(result.days).toBe(5);
      expect(result.days_detail).toBeDefined();
      expect(result.budget_breakdown).toBeDefined();
    });
  });

  describe('save', () => {
    it('should save a plan to database', async () => {
      const userId = 'test-user-id';
      const planData = {
        destination: 'é•¿æ²™',
        days: 5,
        startDate: '2026-02-01',
        budget: 3000,
        peopleCount: 2,
        preferences: ['æ–‡åŒ–', 'ç¾é£Ÿ'],
        daysDetail: {},
        budgetBreakdown: {}
      };

      const result = await planService.save(userId, planData);

      expect(result).toBeDefined();
      expect(result.id).toBeDefined();
      expect(result.user_id).toBe(userId);
    });
  });
});
```

### 9.2 é›†æˆæµ‹è¯•

```javascript
// backend/src/routes/__tests__/planRoutes.test.js
import { describe, it, expect, beforeAll, afterAll } from '@jest/globals';
import request from 'supertest';
import { app } from '../../index';

describe('Plan Routes', () => {
  let authToken;

  beforeAll(async () => {
    // å‡†å¤‡æµ‹è¯•ç”¨æˆ·å’Œè®¤è¯ token
    authToken = 'test-token';
  });

  afterAll(async () => {
    // æ¸…ç†æµ‹è¯•æ•°æ®
  });

  describe('POST /api/plan/generate', () => {
    it('should generate a plan', async () => {
      const response = await request(app)
        .post('/api/plan/generate')
        .set('Authorization', `Bearer ${authToken}`)
        .send({
          destination: 'é•¿æ²™',
          days: 5,
          startDate: '2026-02-01',
          budget: 3000,
          peopleCount: 2,
          preferences: ['æ–‡åŒ–', 'ç¾é£Ÿ']
        });

      expect(response.status).toBe(200);
      expect(response.body.success).toBe(true);
      expect(response.body.data).toBeDefined();
    });
  });
});
```

---

## 10. æ€§èƒ½ä¼˜åŒ–

### 10.1 å‰ç«¯ä¼˜åŒ–

- **ä»£ç åˆ†å‰²**ï¼šä½¿ç”¨ Vue Router çš„æ‡’åŠ è½½
- **èµ„æºå‹ç¼©**ï¼šå¯ç”¨ Gzip å‹ç¼©
- **å›¾ç‰‡ä¼˜åŒ–**ï¼šä½¿ç”¨ WebP æ ¼å¼ï¼Œæ‡’åŠ è½½
- **ç¼“å­˜ç­–ç•¥**ï¼šåˆç†è®¾ç½® HTTP ç¼“å­˜å¤´
- **CDN åŠ é€Ÿ**ï¼šé™æ€èµ„æºä½¿ç”¨ CDN

### 10.2 åç«¯ä¼˜åŒ–

- **æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–**ï¼šæ·»åŠ ç´¢å¼•ï¼Œä½¿ç”¨è¿æ¥æ± 
- **ç¼“å­˜ç­–ç•¥**ï¼šä½¿ç”¨ Redis ç¼“å­˜çƒ­ç‚¹æ•°æ®
- **å¼‚æ­¥å¤„ç†**ï¼šè€—æ—¶æ“ä½œä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—
- **è´Ÿè½½å‡è¡¡**ï¼šä½¿ç”¨ Nginx è¿›è¡Œè´Ÿè½½å‡è¡¡

### 10.3 AI æœåŠ¡ä¼˜åŒ–

- **è¯·æ±‚åˆå¹¶**ï¼šæ‰¹é‡å¤„ç†ç›¸ä¼¼è¯·æ±‚
- **ç»“æœç¼“å­˜**ï¼šç¼“å­˜ AI ç”Ÿæˆç»“æœ
- **è¶…æ—¶æ§åˆ¶**ï¼šè®¾ç½®åˆç†çš„è¯·æ±‚è¶…æ—¶æ—¶é—´
- **é™çº§ç­–ç•¥**ï¼šAI æœåŠ¡å¤±è´¥æ—¶è¿”å›é»˜è®¤æ–¹æ¡ˆ

---

## 11. å®‰å…¨è§„èŒƒ

### 11.1 è®¤è¯å®‰å…¨

- ä½¿ç”¨ HTTPS ä¼ è¾“
- Token è¿‡æœŸæœºåˆ¶
- æ•æ„Ÿæ“ä½œäºŒæ¬¡éªŒè¯
- ç™»å½•å¤±è´¥æ¬¡æ•°é™åˆ¶

### 11.2 æ•°æ®å®‰å…¨

- æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
- SQL æ³¨å…¥é˜²æŠ¤
- XSS æ”»å‡»é˜²æŠ¤
- CSRF ä»¤ç‰ŒéªŒè¯

### 11.3 API å®‰å…¨

- è¯·æ±‚é¢‘ç‡é™åˆ¶
- IP ç™½åå•ï¼ˆå¯é€‰ï¼‰
- API å¯†é’¥ç®¡ç†
- æ—¥å¿—è®°å½•å’Œå®¡è®¡

---

## 12. ç›‘æ§ä¸æ—¥å¿—

### 12.1 æ—¥å¿—è§„èŒƒ

```javascript
// backend/src/utils/logger.js
import winston from 'winston';

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.json()
  ),
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' })
  ]
});

if (process.env.NODE_ENV !== 'production') {
  logger.add(new winston.transports.Console({
    format: winston.format.simple()
  }));
}

export default logger;
```

### 12.2 æ€§èƒ½ç›‘æ§

- API å“åº”æ—¶é—´ç›‘æ§
- é”™è¯¯ç‡ç›‘æ§
- AI æœåŠ¡è°ƒç”¨ç›‘æ§
- æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½ç›‘æ§

### 12.3 å‘Šè­¦æœºåˆ¶

- API å¤±è´¥ç‡è¶…è¿‡é˜ˆå€¼å‘Šè­¦
- AI æœåŠ¡å“åº”è¶…æ—¶å‘Šè­¦
- æ•°æ®åº“è¿æ¥å¼‚å¸¸å‘Šè­¦
- æœåŠ¡å™¨èµ„æºä½¿ç”¨ç‡å‘Šè­¦

---

## 13. é™„å½•

### 13.1 å¸¸è§é—®é¢˜

**Q: å¦‚ä½•é‡ç½® Supabase æ•°æ®åº“ï¼Ÿ**
A: åœ¨ Supabase æ§åˆ¶å°çš„ SQL ç¼–è¾‘å™¨ä¸­è¿è¡Œ `supabase-setup.sql`ã€‚

**Q: AI ç”Ÿæˆå¤±è´¥å¦‚ä½•å¤„ç†ï¼Ÿ**
A: æ£€æŸ¥ DeepSeek API Key æ˜¯å¦æ­£ç¡®ï¼ŒæŸ¥çœ‹åç«¯æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯ã€‚

**Q: åœ°å›¾ä¸æ˜¾ç¤ºæ€ä¹ˆåŠï¼Ÿ**
A: ç¡®è®¤é«˜å¾·åœ°å›¾ API Key æ˜¯å¦æ­£ç¡®ï¼Œæ£€æŸ¥ç½‘ç»œè¿æ¥ã€‚

### 13.2 å‚è€ƒèµ„æ–™

- [Vue 3 å®˜æ–¹æ–‡æ¡£](https://vuejs.org/)
- [Supabase æ–‡æ¡£](https://supabase.com/docs)
- [DeepSeek API æ–‡æ¡£](https://platform.deepseek.com/api-docs/)
- [LangChain æ–‡æ¡£](https://js.langchain.com/)
- [é«˜å¾·åœ°å›¾ API æ–‡æ¡£](https://lbs.amap.com/api/javascript-api/summary)

---

**æ–‡æ¡£ç»“æŸ**
