# 尺素·锦书 - AI旅游明信片功能说明

## 功能概述

"尺素·锦书"功能基于您的旅行计划，使用AI生成精美的旅游明信片。该功能集成了以下技术：

- **阿里百炼/GitCode AI**：用于生成明信片内容和设计建议
- **模板系统**：提供多种明信片模板选择
- **个性化内容**：根据旅行地点和活动自动生成个性化文案

## 功能流程

1. 用户在旅行计划详情页点击"尺素·锦书"按钮
2. 系统跳转到明信片生成页面
3. **用户选择明信片模板**（可选：古典风格、现代简约、手绘风格、照片拼贴等）
4. **自定义内容输入**（可选）：用户可修改系统生成的明信片内容
5. AI根据旅行计划生成个性化明信片内容
6. 生成明信片图片，用户可以下载或重新生成


## 使用说明

### 用户操作流程

1. **生成旅行计划**：在"智能规划"页面生成旅行计划
2. **查看计划详情**：进入计划详情页
3. **生成明信片**：点击右侧顶部"快捷操作"卡片中的"尺素·锦书"按钮
4. **选择模板**：
   - 古典风格：传统明信片设计，适合古城镇旅行
   - 现代简约：简洁设计，适合城市旅行
   - 手绘风格：手绘元素，适合自然风光
   - 照片拼贴：旅行照片组合，适合多景点行程
5. **确认内容**：系统自动生成明信片文案，可进行修改
6. **生成明信片**：点击"生成明信片"按钮
7. **查看结果**：生成完成后可以：
   - 查看完整的明信片图片
   - 下载明信片到本地
   - 查看生成的文案内容
   - 重新生成（如果对结果不满意）

### UI 界面设计

- **渐变色标题卡片**：紫色系渐变背景，体现明信片主题
- **模板选择区域**：四种模板卡片，预览图+名称的卡片式设计
- **内容编辑区**：支持明信片标题和正文的编辑
- **预览区域**：实时显示明信片效果
- **明信片展示区域**：
  - 明信片完整图片
  - 明信片文字内容
  - 下载、分享、重新生成按钮

## 明信片生成逻辑

系统会根据以下信息智能生成明信片：

- 目的地名称和特色
- 旅行天数和主题
- 主要景点和活动
- 旅行季节和天气

生成逻辑：
1. **模板匹配**：根据目的地类型和旅行主题推荐合适的模板
2. **文案生成**：
   - 标题：简洁有力的旅行主题概括
   - 正文：包含旅行亮点和个人感受
   - 落款：旅行日期和署名
3. **设计元素**：
   - 地域特色元素（如当地建筑、自然景观）
   - 旅行主题元素（如沙滩、山脉、城市天际线）
   - 装饰性边框和图案

### 模板风格说明

- **古典风格**：
  - 传统边框设计
  - 书法字体
  - 古典装饰元素
  - 适合：历史古镇、传统文化旅行

- **现代简约**：
  - 简洁线条设计
  - 现代字体
  - 几何装饰元素
  - 适合：城市观光、现代建筑旅行

- **手绘风格**：
  - 手绘插图元素
  - 亲和力字体
  - 自然色彩
  - 适合：自然风光、户外旅行

- **照片拼贴**：
  - 多照片组合布局
  - 透明度叠加
  - 照片边框装饰
  - 适合：多景点行程、综合旅行

## 错误处理

### 常见错误及解决方案

1. **"请先生成旅行计划"**
   - 系统检测到没有有效的旅行计划
   - 返回规划页面生成新的旅行计划

2. **"生成失败：网络错误"**
   - 检查网络连接是否正常
   - 确认AI API Key是否正确配置
   - 查看后端日志了解详细错误

3. **"生成失败：API密钥无效"**
   - 检查AI_API_KEY是否正确
   - 确认API密钥未过期
   - 重新配置有效的API密钥

4. **"生成失败：内容违规"**
   - AI生成的明信片内容可能包含敏感词汇
   - 点击"重新生成"按钮重试
   - 如持续出现，可能需要调整内容生成逻辑

5. **"模板加载失败"**
   - 检查模板文件是否存在
   - 确认模板文件格式正确
   - 重新部署模板文件

## 技术架构

### 前端部分

- **HandbookView.vue**：旅游明信片生成页面
  - 模板选择界面
  - 内容编辑和预览功能
  - 明信片展示和操作功能
  - 下载和分享功能

### 后端部分

- **POST /api/generate-postcard**：生成旅游明信片
  - 输入：
    - `destination`: 目的地
    - `duration`: 旅行天数
    - `dailyItinerary`: 每日行程
    - `template`: 明信片模板类型
    - `customContent`: 用户自定义内容
  - 输出：包含明信片图片URL和文字内容的对象

- **GET /api/postcard-templates**：获取可用的明信片模板列表
  - 输出：模板数组，包含模板ID、名称、预览图和描述

## 未来优化方向

1. **更多模板选择**：增加节日主题、季节主题等特殊模板
2. **照片上传**：支持用户上传自己的旅行照片融入明信片
3. **手写效果**：模拟真实手写效果的文字渲染
4. **邮戳功能**：添加目的地特色邮戳元素
5. **批量生成**：支持一次性生成多张不同风格的明信片
6. **实体打印**：集成打印服务，支持实际明信片打印和邮寄

## 注意事项

1. 生成的明信片仅供数字使用，不包含实际打印服务
2. 明信片内容基于AI生成，可能与实际情况有所差异
3. 如遇到生成失败，尝试更换不同模板或修改自定义内容
4. 自定义内容描述越具体，生成的明信片可能越贴合需求

## 问题反馈

如在使用过程中遇到问题，请检查：

1. 环境变量是否正确配置
2. 服务器日志中的错误信息
3. 旅行计划是否已生成
4. 模板文件是否存在且格式正确
5. 网络连接是否正常

---

更新时间：2025年11月29日