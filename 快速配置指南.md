# 快速配置指南 - AI速记卡片功能

## 第一步：配置环境变量

在项目根目录的 `backend/.env` 文件中添加以下配置：

```env
# 腾讯云混元生图配置（必需）
TENCENT_SECRET_ID=你的腾讯云SecretId
TENCENT_SECRET_KEY=你的腾讯云SecretKey
```

## 第二步：获取腾讯云密钥

### 方法一：通过控制台获取

1. 登录 [腾讯云控制台](https://console.cloud.tencent.com/)
2. 点击右上角头像 -> 访问管理
3. 在左侧菜单选择"访问密钥" -> "API密钥管理"
4. 点击"新建密钥"创建新的密钥对
5. 复制 `SecretId` 和 `SecretKey` 到 `.env` 文件

### 方法二：使用子账号（推荐）

为了安全考虑，建议创建子账号并只授予混元生图的权限：

1. 在"访问管理"中选择"用户" -> "用户列表"
2. 创建新用户，选择"编程访问"
3. 在权限设置中，搜索并添加 `QcloudAIARTFullAccess` 策略
4. 完成创建后，获取该子账号的 SecretId 和 SecretKey

## 第三步：开通混元生图服务

1. 访问 [混元生图产品页](https://cloud.tencent.com/product/aiart)
2. 点击"立即体验"或"立即购买"
3. 开通服务（可能需要实名认证）
4. 充值一定金额（建议至少10元）用于测试

## 第四步：测试配置

启动项目后，查看后端日志：

```bash
cd backend
npm start
```

如果看到以下信息，说明配置成功：

```
✅ 混元生图客户端初始化成功
=== 配置状态 ===
✓ 混元生图: 已配置 ✅
```

## 第五步：使用功能

1. 访问前端页面：`http://localhost:5173`
2. 生成一个旅行计划
3. 在计划详情页，点击右上角"生成AI速记卡片"按钮
4. 等待生成完成（约10-30秒）
5. 查看和下载生成的图片

## 费用说明

- **混元生图极速版**：约 0.1-0.2 元/次
- 首次使用建议充值 10-50 元进行测试
- 可在腾讯云控制台查看详细计费记录

## 常见问题

### Q: 提示"混元生图功能当前不可用"

**A:** 检查以下几点：
- 环境变量是否正确配置
- 是否重启了后端服务
- 密钥是否正确（没有多余空格）

### Q: 提示"腾讯云认证失败"

**A:** 可能原因：
- SecretId 或 SecretKey 错误
- 密钥已过期或被删除
- 子账号权限不足

### Q: 提示"账号已欠费"

**A:** 
- 登录腾讯云控制台充值
- 检查账户余额和计费账单

### Q: 生成速度很慢

**A:**
- 正常情况下需要 10-30 秒
- 如果超过 1 分钟，检查网络连接
- 查看后端日志是否有错误

### Q: 图片质量不理想

**A:**
- 点击"重新生成"多试几次
- 不同的随机种子会产生不同效果
- 可以在后端调整提示词优化逻辑

## 安全建议

1. **不要将 .env 文件提交到版本控制系统**
2. **使用子账号密钥**，不要使用主账号密钥
3. **定期更换密钥**，特别是怀疑泄露时
4. **限制子账号权限**，只授予必需的权限
5. **监控费用**，设置消费警报避免超支

## 技术支持

如需帮助，请查看：
- [腾讯云混元生图文档](https://cloud.tencent.com/document/product/1729)
- [混元生图API参考](https://cloud.tencent.com/document/api/1729/101061)
- 项目 `AI速记卡片功能说明.md` 文件

---

配置完成后即可开始使用！🎉
